<?xml version="1.0"?>
<root main_tree_to_execute="BehaviorTree">
    <!-- ////////// -->
    <BehaviorTree ID="BehaviorTree">
        <Parallel threshold="2" name="mather">
            <Sequence name="control">
                <!-- <Inverter> -->
                    <Action ID="BTWaitForTarget" targetout="{TargetPose}" targetin="{TargetPose}" statewaittarget="{waittarget}" stateexecutefree="{executefree}"/>
                <!-- </Inverter>
                <Inverter> -->
                    <Action ID="BTPathPlanning" goal="{TargetPose}" makeplan="{Plan}"/>
                <!-- </Inverter> -->
                <!-- <Inverter> -->
                <Action ID="BTFollowPath" planedplan="{Plan}" statewaittarget="{waittarget}" stateexecutefree="{executefree}"/>
                <!-- </Inverter> -->
            </Sequence>
            
            <Fallback name="pick">
                <Inverter>
                    <Action ID="BTCameraFindTarget" targetout="{observedpose}"/>
                </Inverter>
                <!-- <Inverter> -->
                <Sequence name="Pick1">
                    <SetBlackboard output_key="height" value="0.20"/>
                    <Action ID="BTCloseToTarget" height="{height}" targetin="{observedpose}" targetout="{TargetPose}" statewaittarget="{waittarget}" stateexecutefree="{executefree}"/>
                <!-- </Sequence>
                </Inverter>    
                <Inverter>
                <Sequence name="Pick2"> -->
                    <SetBlackboard output_key="height" value="-0.15"/>
                    <Action ID="BTCloseToTarget" height="{height}" targetin="{observedpose}" targetout="{TargetPose}" statewaittarget="{waittarget}" stateexecutefree="{executefree}"/>
                <!-- </Sequence>
                </Inverter>    
                <Inverter>
                <Sequence name="Pick3">                     -->
                    <SetBlackboard output_key="height" value="0.10"/>
                    <Action ID="BTCloseToTarget" height="{height}" targetin="{observedpose}" targetout="{TargetPose}" statewaittarget="{waittarget}" stateexecutefree="{executefree}"/>
                </Sequence>
                <!-- </Inverter>     -->
            </Fallback>
            
        </Parallel>
    </BehaviorTree>
    <!-- ////////// -->
    <TreeNodesModel>
        <Action ID="BTCameraFindTarget">
            <output_port default="{observedpose}" name="targetout"/>
        </Action>
        <Action ID="BTCloseToTarget">
            <input_port default="{height}" name="height"/>
            <input_port default="{observedpose}" name="targetin"/>
            <output_port default="{TargetPose}" name="targetout"/>
        </Action>
        <Action ID="BTFollowPath">
            <input_port default="{Plan}" name="planedpaln"/>
        </Action>
        <Action ID="BTPathPlanning">
            <input_port default="{TargetPose}" name="goal"/>
            <output_port default="{Plan}" name="makeplan"/>
        </Action>
        <Action ID="BTWaitForTarget">
            <output_port default="{TargetPose}" name="targetout"/>
        </Action>
        <Condition ID="NewGoal">
            <input_port name="globalgoal"/>
        </Condition>
        <Action ID="OpenGripper"/>
    </TreeNodesModel>
    <!-- ////////// -->
</root>

